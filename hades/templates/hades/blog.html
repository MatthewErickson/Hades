{% extends "hades/base.html" %}
{% load static %}

{% block title %}Blog{% endblock %}

{% block content %}
<div class="container">
	{% if blogs %}
		<div class="container">
			<div class="left normal">
				<a id="prev" class="gone">
					<button class="btn btn-default center">Prev</button>
				</a>
			</div>
			<div class="right normal">
				<a id="next" class="gone">
					<button class="btn btn-default center">Next</button>
				</a>
			</div>
		</div>
		{% for blog in blogs %}
			<div class="entry">
				<div class="larger">
					<h3><strong>{{ blog.title }}</strong></h3>
				</div>
				<p class="smaller"><i>{{ blog.post_date }}</i></p>
				<div id="{{ blog.id }}" class="normal">
					<p>{{ blog.content }}</p>
				</div>
			</div>
		{% endfor %}
	{% else %}
		<div class="container center">
			<h3>No posts available</h3>
		</div>
	{% endif %}
	<div class="container center">
		<button class="btn btn-default center" onclick="toggleForm()">Create entry</button>
	</div>
	<div id="createEntry" class="container row gone center">
		<form class="form-group" action="{% url 'hades:blog' %}" method="POST">
			{% csrf_token %}
			{{ form.as_p }}
			<input class="btn btn-primary" type="submit" value="Submit">
		</form>
	</div>
</div>
{% endblock %}

{% block css %}
	{{ block.super }}
	<link rel="stylesheet" type="text/css" href="{% static 'hades/css/blog.css' %}">
{% endblock %}

{% block javascript %}
	{{ block.super }}

<script type="text/javascript">
	var page = parseInt({{ page }}),
		lastPage = parseInt({{ lastPage }}),
		$prev = $("#prev"),
		$next = $("#next"),
		$form = $("#createEntry");

	function showElement($el) {
		$el.removeClass('gone');
		$el.addClass('inline');
	}

	function hideElement($el) {
		$el.removeClass('inline');
		$el.addClass('gone');
	}

	function toggleForm() {
		if ($form.hasClass('gone')) {
			showElement($form);
		}
		else {
			hideElement($form);
		}
	}

	if (page > 0) {
		showElement($prev);
	}

	if (page < lastPage) {
		showElement($next);
	}

	$prev.attr('href', '/blog/' + (page-1));
	$next.attr('href', '/blog/' + (page+1));
</script>
{% endblock %}
