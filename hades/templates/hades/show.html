{% extends "hades/base.html" %}
{% load static %}

{% block title %}Hades - {{ showName }}{% endblock %}

{% block content %}
<div class="container">
	<div class="center">
		<h1>{{ show.name }}</h1>
	</div>
	<span class="hidden aria-hidden" id="videoAnchor"></span>
	<div class="center">
		<video controls id="video" class="container center">
			<source type="video/mp4" id="source">
		</video>
	</div>

	<div class="container">
	{% if episodes %}
		<div class="row">
		{% for episode in episodes %}
			{% if episode.number == 1 %}
			<div class="col-xs-12">
				<h2 class="center">Season {{ episode.season }}</h2>
			</div>
			{% endif %}
			<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
				<button class="btn btn-default hades-button margin10 video-button"
				onclick="loadEpisode({{ episode.season }}, {{ episode.number }});">
					{{ episode }}
				</button>
			</div>
		{% endfor %}
		</div>
	{% endif %}
	</div>
</div>

<script type="text/javascript">
	var showName = '{{ show.name }}',
		video = $("#video"),
		source = $("#source"),
		anchor = $("#videoAnchor");

	video.addClass('gone');

	function pad(number) {
		var str = "" + number;
		var pad = "00";
		return pad.substring(0, pad.length - str.length) + str;
	}
	
	function loadEpisode(season, number) {
		video.removeClass('gone');
		var vidPath = showName.replace(/ /g,"-") + "/s" + season + "/e" + pad(number) + ".mp4";
		source.attr("src", "{% static 'hades/video/' %}" + vidPath);
		video[0].load();
		$('html, body').animate({
			scrollTop: anchor.offset().top
		}, 1000);
		video[0].play();
	}
</script>
{% endblock %}

{% block nav-right %}
	<a href="/login/">Login</a>
{% endblock %}